
# SLES Supported OS Kernel/Distribution
  Our current backport supports the following OS Distribution.

| OS Distribution | OS Version | Kernel Version  |
|---  |---  |---  |
| SLES | 15SP4 | Kernel 5.14 |
  
  The kernel header used at the time of backporting may not be compatible with the latest version at the time of installation.
  Please refer [Version](https://github.com/intel-gpu/intel-gpu-i915-backports/blob/backport/main/versions) file to get information on the kernel version being used during backporting.

  In case of an issue with the latest kernel, please install the kernel version mentioned in version file for appropriate OS version.

For SLES15SP4:
```
sudo zypper ref -s && sudo zypper install -y kernel-default-<SLES15_SP4_KERNEL_VERSION> \
kernel-syms-<SLES15_SP4_KERNEL_VERSION>

example:
	sudo zypper ref -s && sudo zypper install -y kernel-default-5.14.21-150400.24.11 \
	kernel-syms-5.14.21-150400.24.11
```

Please note that dkms installation will skip if the kernel headers are not installed.

# Prerequisite
we have dependencies on the following packages

For SLES
  - make
  - linux-glibc-devel
  - lsb-release
  - rpm-build
  - flex
  - bison
  - awk
```
sudo zypper install make linux-glibc-devel lsb-release rpm-build bison flex awk
```
For dkms packages, we need to install `dkms` package along with above packages.

```
sudo zypper install dkms
```
# Dependencies

This driver is part of a collection of kernel-mode drivers that enable support for Intel graphics. The backports collection within https://github.com/intel-gpu includes:

- [Intel速 Graphics Driver Backports for Linux](https://github.com/intel-gpu/intel-gpu-i915-backports) - The main graphics driver (includes a compatible DRM subsystem and dmabuf if necessary)
- [Intel速 Converged Security Engine Backports](https://github.com/intel-gpu/intel-gpu-cse-backports) - Converged Security Engine
- [Intel速 Platform Monitoring Technology Backports](https://github.com/intel-gpu/intel-gpu-pmt-backports/) - Intel Platform Telemetry
- [Intel速 GPU firmware](https://github.com/intel-gpu/intel-gpu-firmware) - Firmware required by intel GPUs.

Each project is tagged consistently, so when pulling these repos, pull the same tag.


# Package creation

## Dynamic Kernel Module Support(DKMS)
We need to create i915 dkms packages using the below command.
```
make i915dkmsrpm-pkg
```
  Above  will create rpm packages at $HOME/rpmbuild/RPMS/x86_64/

### DKMS Installation
 ```
sudo rpm -ivh intel-i915-dkms*.rpm
# Reboot the device after installation of all packages.
sudo reboot
```

## Binary RPM
Creation of binary rpm can be done using the below command.
```
make binrpm-pkg
```
Generated Files:
intel-i915-kmp-default-<version>-1.x86_64.rpm

### Binary Installation
 ```
sudo rpm -ivh intel-i915-kmp-default*.rpm
# Reboot the device after installation of all packages.
sudo reboot
```
## Installation verification

Please grep **backport**  from dmesg after reboot. you should see something like below
```
> sudo dmesg |grep -i backport
[    5.963854] COMPAT BACKPORTED INIT
[    5.968761] Loading modules backported from DII_6068_prerelease
[    5.976154] Backport generated by backports.git I915_6068_PRERELEASE_220812.0
[    6.069699] [drm] I915 BACKPORTED INIT
```


