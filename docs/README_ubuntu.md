
# Ubuntu Supported OS Kernel/Distribution
  Our current backport supports the following OS Distribution.


| OS Distribution | OS Version | Kernel Version  |
|---  |---  |---  |
| Ubuntu® | 22.04 | Kernel 5.19 generic |
| | 22.04 |  Kernel 5.17 oem |
| | 20.04 |  Kernel 5.15 generic |

  The kernel header used at the time of backporting may not be compatible with the latest version at the time of installation.
  Please refer [Version](https://github.com/intel-gpu/intel-gpu-i915-backports/blob/backport/main/versions) file to check value of UBUNTU_OEM_20.04_KERNEL_VERSION/UBUNTU_OEM_22.04_KERNEL_VERSION for Ubuntu. It will point to the kernel version which is being used during backporting.

  In case of an issue with the latest kernel, please install the kernel version mentioned in version file for appropriate OS version.

  For Ubuntu 22.04:
```
sudo apt install linux-headers-<UBUNTU_OEM_22.04_KERNEL_VERSION>-oem \
linux-image-unsigned-<UBUNTU_OEM_22.04_KERNEL_VERSION>-oem

example:
       sudo apt install linux-headers-5.17.0-1006-oem\
       linux-image-unsigned-5.17.0-1006-oem
```
  For Ubuntu 20.04:
```
sudo apt install linux-headers-<UBUNTU_OEM_20.04_KERNEL_VERSION>-generic \
linux-image-unsigned-<UBUNTU_OEM_20.04_KERNEL_VERSION>-generic

example:
       sudo apt install linux-headers-5.15.0-41-generic\
       linux-image-unsigned-5.15.0-41-generic
```

Please note that dkms installation will skip if the kernel headers are not installed.

# Prerequisite
we have dependencies on the following packages
For Ubuntu
  - dkms
  - make
  - debhelper
  - devscripts
  - build-essential
  - flex
  - bison
  - awk

```
sudo apt install dkms make debhelper devscripts build-essential flex bison awk
```

# Dependencies

This driver is part of a collection of kernel-mode drivers that enable support for Intel graphics. The backports collection within https://github.com/intel-gpu includes:

- [Intel® Graphics Driver Backports for Linux](https://github.com/intel-gpu/intel-gpu-i915-backports) - The main graphics driver (includes a compatible DRM subsystem and dmabuf if necessary)
- [Intel® Converged Security Engine Backports](https://github.com/intel-gpu/intel-gpu-cse-backports) - Converged Security Engine
- [Intel® Platform Monitoring Technology Backports](https://github.com/intel-gpu/intel-gpu-pmt-backports/) - Intel Platform Telemetry
- [Intel® GPU firmware](https://github.com/intel-gpu/intel-gpu-firmware) - Firmware required by intel GPUs.

Each project is tagged consistently, so when pulling these repos, pull the same tag.


# Dynamic Kernel Module Support(DKMS) based package creation

## Ubuntu
There are two ways to create i915 dkms packages.
1. Using default command :
```
$make i915dkmsdeb-pkg
example:
        $make i915dkmsdeb-pkg
        generated package name :
                intel-i915-dkms_0.6411.221110.0.5.17.0.1020+i1-1_all.deb
```

2. Using os_distribution as an option :
```
$make i915dkmsdeb-pkg OS_DISTRIBUTION=<os_distribution>
example:
        $make i915dkmsdeb-pkg OS_DISTRIBUTION=UBUNTU_GENERIC
        generated package name :
                intel-i915-dkms_0.6411.221110.0.5.15.0.53+i1-1_all.deb
```
Above cmd will create debain package in parent folder. **intel-i915-dkms_<**release version**>.<**kernel-version**>.deb**

Use below help command to get the list of supported os distributions.
```
$make i915dkmsdeb-pkg-help
Debian package contains the default kernel version (KV of UBUNTU_OEM_22.04)
To create the package with specific kernel version, pass the supported kernel name to OS_DISTRIBUTION option

##### List of supported osv kernel versions #####
UBUNTU_OEM_22.04
UBUNTU_OEM_20.04
UBUNTU_22.04_GENERIC
UBUNTU_20.04_GENERIC
VANILLA_5.15LTS

Example: make i915dkmsdeb-pkg OS_DISTRIBUTION=UBUNTU_22.04_GENERIC

```

### Installation
```
sudo dpkg -i intel-i915-dkms_*.deb
```
#### Reboot the device after installation of all packages.
```
sudo reboot
```

## Installation verification

Please grep **backport**  from dmesg after reboot. you should see something like below
```
> sudo dmesg |grep -i backport
[    5.963854] COMPAT BACKPORTED INIT
[    5.968761] Loading modules backported from DII_6068_prerelease
[    5.976154] Backport generated by backports.git I915_6068_PRERELEASE_220812.0
[    6.069699] [drm] I915 BACKPORTED INIT
```


